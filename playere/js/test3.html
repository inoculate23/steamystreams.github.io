<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Primary Meta Tags -->
    <title>videos</title>
    <meta name="title" content="vids">
    <meta name="description" content="">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.15.2/ace.js"></script>

    <style>
        #header1 {
            margin-left: 25px;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }
        
        .hh {
            padding-right: 6px;
            width: 270px;
        }
    </style>
</head>
<script>
    
    let rec_button;
    window.onload = function() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var data = JSON.parse(this.responseText);
                for (let i = 0; i < 700; i++) {
                    var d = new Date();
                    const thumb = document.createElement('img');
                    thumb.setAttribute("id", data.results[i].username);
                    thumb.setAttribute("class", "cb_button");
                    thumb.setAttribute('onclick', 'myfunction_' + data.results[i].username + '()');
                    const link = document.createElement('a');
                    link.setAttribute('href', 'https://inoculate.media/hls/player_light.html?src=https://edge18-lax.live.mmcdn.com/live-hls/amlst:' + data.results[i].username + '/playlist.m3u8', );

                    thumb.innerText = data.results[i].username;

                    const rec_button = document.createElement('button');
                    rec_button.setAttribute("id", data.result.folders[i].name);
                    rec_button.setAttribute("class", "rec_button");

                    rec_button.setAttribute('onclick', 'function' + Recorder + '()' );

                    var header1 = document.getElementById('header1');
                    header1.appendChild(link);
                    header1.append(rec_button);
            
function Recorder() {
const FFmpeg = require('node-ffmpeg-pro')
new FFmpeg()
.Input('https://edge18-lax.live.mmcdn.com/live-hls/amlst:' +  data.results[i].username + '/playlist.m3u8',);
  .Output('recordings/test.mp4')   .Run('./dist/ffmpeg', FFmpeg.OverWriteOutput());

                    // JavaScript example using jQuery


                    // Active camera will refresh every 2 seconds
                    //  var TIMEOUT = 20000;
                    // var refreshInterval = setInterval(function() {
                    // var random = Math.floor(Math.random() * Math.pow(3, 100));
                    //   $('img#camera').attr('src', 'https://cbjpeg.stream.highwebmedia.com/riw/crown_of_vice01.jpg?' + +d.getTime());

                    //  d = new Date();
                    $(thumb).attr("src", 'https://cbjpeg.stream.highwebmedia.com/riw/' + data.results[i].username + '.jpg?' + d.getTime());
                    link.append(thumb)
                       


                    }
                    }


            }


        }



        xhttp.open("GET", "https://chaturbate.com/api/public/affiliates/onlinerooms/?wm=aqAcE&client_ip=request_ip&limit=200&hd=true&gender=f&embed_video_only=1", );
        xhttp.send();

    }
</script>
    <header id="header1"></header>
    <hr class="my-5" />
    <div id="content"></div>

    </div>

    <p>

<script src="../js/hls.js"></script>
</body>

</html>